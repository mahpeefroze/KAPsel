<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<h:outputStylesheet name="global.css" library="css"/> 

<h:head>

<title>#{labels.progName} #{labels.produkt}</title>

</h:head>

<body> 

<div id="header" class="float_frame">
		<h:form id="ribbon_form">
			<p:ribbon>
				<p:tab title="#{labels.produkt}">
					<p:ribbonGroup>
						<h1>#{labels.produkt}</h1>
					</p:ribbonGroup>

					<p:ribbonGroup label="#{labels.action}">
						<p:commandButton value="New" icon="fa fa-codepen"
							styleClass="ui-ribbon-bigbutton" update=":produktNewDlg" oncomplete="PF('newProdukt').show()"/>
						<p:commandButton value="Edit" icon="fa fa-edit"
							styleClass="ui-ribbon-bigbutton" type="button" onclick="" /> 
						<p:commandButton value="Delete" icon="fa fa-trash"
							styleClass="ui-ribbon-bigbutton" oncomplete="PF('delProdukt').show();" disabled="#{produktBean.emptyList}"/>
					</p:ribbonGroup>

					<p:ribbonGroup label="#{labels.export}">
						<p:commandButton value="To PDF" icon="fa fa-file-pdf-o"
							styleClass="ui-ribbon-bigbutton" type="button" />
						<p:commandButton value="To Word" icon="fa fa-file-word-o"
							styleClass="ui-ribbon-bigbutton" type="button" />
					</p:ribbonGroup>

					<p:ribbonGroup label="#{labels.print}">
						<p:commandButton value="Print" icon="fa fa-print"
							styleClass="ui-ribbon-bigbutton" type="button" />
					</p:ribbonGroup>
					
					<p:ribbonGroup label="Optionen" style="float: right;">
						<p:commandButton value="#{labels.menu}" icon="fa fa-home" styleClass="ui-ribbon-bigbutton" action="index"/>
					</p:ribbonGroup>

				</p:tab>

			</p:ribbon>
			
		</h:form>
		
	</div>


	<div id="middle">

		<!-- LINKE SEITE -->
		<h:form id="nav_form">
			<div id="nav_container">
				<div id="nav" class="float_frame">

					<!-- Tabelle mit allen Aufträgen -->
					<p:dataTable id="produktDT" var="item"
						value="#{produktBean.produkte}" selectionMode="single"
						selection="#{produktBean.selectedProdukt}" rowKey="#{item.pnr}"
						emptyMessage="#{labels.norecords}">
						<f:facet name="header">#{labels.prodListe}</f:facet>


						<p:ajax event="rowSelect" listener="#{produktBean.loadProdukt}"
							update=":sect_form" />

						<p:column headerText="#{labels.p_nr}">
							<h:outputText value="#{item.pnr}" />
						</p:column>
						<p:column headerText="#{labels.nachname}">
							<h:outputText value="#{item.name}" />
						</p:column>
						<p:column headerText="#{labels.erstDatum}">
							<h:outputText value="#{item.erstDatum}" >
								<f:convertDateTime pattern="dd.MM.yyyy" />
							</h:outputText>
						</p:column>
						<p:column headerText="#{labels.modDatum}">
							<h:outputText value="#{item.modDatum}">
								<f:convertDateTime pattern="dd.MM.yyyy" />
							</h:outputText>
						</p:column>
					</p:dataTable>

					<hr></hr>
				</div>
			</div>
		</h:form>
		
		<!-- RECHTE SEITE -->
		<h:form id="sect_form">
			<div id="section_container">
				<div id="section" class="float_frame">
					<p:accordionPanel multiple="true">


						<!-- Produktdetails -->
						<p:tab title="#{labels.prodDetail}">
							<br></br>
							<h:panelGrid columns="2" styleClass="fullWidth">
								<h:outputText value="#{produktBean.selectedProdukt.name}" />
								<h:outputText id="statusbox" value="#{labels.status}: " />
							</h:panelGrid>
							<br></br>
							<p:fieldset style="margin-bottom:10px;">
								<p:panelGrid>
									<p:row>
										<p:column>#{labels.pnr}:</p:column>
										<p:column>#{produktBean.selectedProdukt.pnr}</p:column>
										<p:column>#{labels.typ}:</p:column>
										<p:column>#{produktBean.selectedProdukt.typ}</p:column>
										<p:column>#{labels.erstDatum}</p:column>
										<p:column>
											<h:outputText value="#{produktBean.selectedProdukt.erstDatum}">
												<f:convertDateTime pattern="dd.MM.yyyy" />
											</h:outputText>
										</p:column>
									</p:row>
									<p:row>
										<p:column colspan="4">
											<p:fieldset legend="#Beschreibung" toggleable="false">
												<h:outputText value="#{produktBean.selectedProdukt.text}"></h:outputText>
											</p:fieldset>
										</p:column>
										<p:column>#{labels.modDatum}:</p:column>
										<p:column>
											<h:outputText value="#{produktBean.selectedProdukt.modDatum}">
												<f:convertDateTime pattern="dd.MM.yyyy" />
											</h:outputText>
										</p:column>
									</p:row>
									<p:row>
										<p:column>#{labels.preis}</p:column>
										<p:column>#{produktBean.selectedProdukt.preis}</p:column>
										<p:column>#{labels.pZeit}</p:column>
										<p:column>#{produktBean.selectedProdukt.zeit}</p:column>
									</p:row>
								</p:panelGrid>
							</p:fieldset>

							<br></br>
						</p:tab>

						<!-- Stueckliste -->
						<p:tab title="#{labels.stueckliste}">
							<!-- Tabelle mit allen Produkten und Leistungen -->
							
							<p:commandButton id="btAddView" update="bauteilDT" title="#{labels.add}" icon="fa fa-plus" actionListener="#{produktBean.addBauteil}" />
							<p:commandButton id="btDelView" update="bauteilDT" title="#{labels.delete}" icon="fa fa-remove" actionListener="#{produktBean.deleteItemView}" />
							
							<p:dataTable id="bauteilDT" var="item" value="#{produktBean.selectedProdukt.bauteile}" selectionMode="single" selection="#{produktBean.selectedBauteil}"
								rowKey="#{item.id}" sortBy="#{item.position}" emptyMessage="#{labels.norecords}" editable="true" editMode="cell">

									
								<p:ajax event="cellEdit" listener="#{produktBean.onBauteileEdit}" update="nav_form"/>	

								<p:column headerText="#{labels.position}" style="width: 40px;">
									<h:outputText value="#{item.position}" />
								</p:column>
								<p:column headerText="#{labels.stueck_zahl}" style="width: 40px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.menge}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.menge}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.bezeichnung}" >
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.name}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.name}" style="width:96%"/></f:facet>
						           </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.prodL}" style="width: 80px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.laenge}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.laenge}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.prodB}" style="width: 80px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.breite}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.breite}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.prodD}" style="width: 80px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.dicke}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.dicke}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.bemerkung}">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.bemerkung}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.bemerkung}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.werkstoff}" style="width: 180px;">
									<p:cellEditor>
										<f:facet name="output"><h:outputText value="#{item.material.name}" /></f:facet>
										<f:facet name="input">
										<p:selectOneMenu id="materialTypSelect" value="#{produktBean.materialId}" styleClass="fullWidth" filter="true" filterMatchMode="contains">
											<f:selectItem itemLabel="Material auswaehlen" itemValue="" noSelectionOption="true" />
											<f:selectItems value="#{materialBean.materialien}" var="mat" itemLabel="#{mat.name} | #{mat.preis} #{labels.waehrung}/#{mat.einheit}" itemValue="#{mat.id}"/>				
										</p:selectOneMenu>
										</f:facet>
									</p:cellEditor>
								</p:column>

							</p:dataTable>
						</p:tab>
						
						<!-- Arbeitsplan -->
						<p:tab title="#{labels.arbeitsplan}">
							
							<p:commandButton id="asAddView" update="arbeitschrittDT" title="#{labels.add}" icon="fa fa-plus" actionListener="#{produktBean.addArbeitsschritt}" />
							<p:commandButton id="asDelView" update="arbeitschrittDT" title="#{labels.delete}" icon="fa fa-remove" actionListener="#{produktBean.deleteItemView}" />
							
							<p:dataTable id="arbeitschrittDT" var="item" value="#{produktBean.selectedProdukt.aschritte}" selectionMode="single" selection="#{produktBean.selectedAschritt}"
								rowKey="#{item.id}" sortBy="#{item.position}" emptyMessage="#{labels.norecords}" editable="true" editMode="cell">

									
								<p:ajax event="cellEdit" listener="#{produktBean.onArbeitsschritteEdit}" update="nav_form"/>

								<p:column headerText="#{labels.position}" style="width: 40px;">
									<h:outputText value="#{item.position}" />
								</p:column>
								<p:column headerText="#{labels.bezeichnung}" style="min-width: 300px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.name}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.name}" style="width:96%"/></f:facet>
						           </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.zeit}" style="width: 60px;">
									<p:cellEditor>
						               <f:facet name="output"><h:outputText value="#{item.zeit}" /></f:facet>
						               <f:facet name="input"><p:inputText value="#{item.zeit}" style="width:96%"/></f:facet>
						            </p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.typ}" style="width: 180px;">
									<p:cellEditor  styleClass="full-width">
						               <f:facet name="output"><h:outputText value="#{item.typ}" /></f:facet>
										<f:facet name="input">
										<p:selectOneMenu id="asTypSelect" value="#{item.typ}" styleClass="fullWidth">
											<f:selectItems value="#{eTypes.aschrittT}"/>
										</p:selectOneMenu>
										</f:facet>
									</p:cellEditor>
								</p:column>
								<p:column headerText="#{labels.werkzeug}" style="width: 200px;">
									<p:cellEditor style="width: 200px;">
						               <f:facet name="output"><h:outputText value="#{item.werkzeug.name}" /></f:facet>
										<f:facet name="input">
										<p:selectOneMenu id="werkzeugSelect" value="#{produktBean.werkzeugId}" styleClass="fullWidth" filter="true" filterMatchMode="contains">
											<f:selectItem itemLabel="Werkzeug auswaehlen" itemValue="" noSelectionOption="true" />
											<f:selectItems value="#{werkzeugBean.werkzeuge}" var="wz" itemLabel="#{wz.name} | #{wz.stundensatz} #{labels.waehrung}/#{labels.stundeH}" itemValue="#{wz.id}"/>				
										</p:selectOneMenu>
										</f:facet>
						            </p:cellEditor>
								</p:column>
							
						

							</p:dataTable>
							
						</p:tab>

						<!-- Statistiken -->
						<p:tab title="#{labels.stats}" disabled="true">

						</p:tab>

					</p:accordionPanel>

					<hr></hr>
					<p:dialog header="Produkt löschen" modal="true" widgetVar="delProdukt" minHeight="40" resizable="false">
						<p>Möchten Sie wirklich dieses Produkt löschen?</p>
					    <hr></hr>
					    <p:commandButton value="#{labels.ja}" action="#{produktBean.deleteProdukt()}" update="nav_form sect_form" oncomplete="PF('delProdukt').hide();"/>
					    <p:commandButton value="#{labels.nein}" onclick="PF('delProdukt').hide();"/>
					</p:dialog>	

				</div>
			</div>
		</h:form>
	</div>

	<div id="footer"></div>
	
	
		
	<p:dialog id="produktNewDlg" header="Neues Produkt" modal="true" widgetVar="newProdukt" style="max-width: 3000px; minHeight: 40px;"  resizable="false">
			<ui:include src="/views/dialogs/produktNew.xhtml"/>
	</p:dialog>

</body> 
</html>

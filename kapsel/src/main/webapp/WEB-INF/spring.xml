<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jee="http://www.springframework.org/schema/jee"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.1.xsd
		http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-4.1.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd">

	
	<!-- Data Source Declaration, kapselDS defined with WildFly WebConsole -->
    <jee:jndi-lookup id="dataSource" jndi-name="java:/jdbc/kapselDS"/>
	
	<!-- Session Factory Declaration -->
    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
		<property name="annotatedClasses">
            <list>
            	<!-- Core -->
                <value>de.kapsel.auftrag.entities.Auftrag</value> <!-- Without this, Auftrag is unknown entity -->
                <value>de.kapsel.kunde.entities.Kunde</value>
                <value>de.kapsel.kunde.entities.KGruppe</value>
                <value>de.kapsel.produkt.entities.Produkt</value>
                <value>de.kapsel.produkt.entities.Bauteil</value>
                <value>de.kapsel.produkt.entities.Material</value>
                <value>de.kapsel.produkt.entities.Arbeitsschritt</value>
                <value>de.kapsel.produkt.entities.Werkzeug</value>
                <!-- Utils/Globals -->
                <value>de.kapsel.um.User</value> 
                <value>de.kapsel.global.Adresse</value>
            </list>
        </property>
        
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
    </bean>
    
   	
   	<!-- USER DECLARATION + [SCHEMA] -->
	<!-- Model Declaration -->
	<bean id="user" class="de.kapsel.um.User" />

	<!-- Service Declaration -->
	<bean id="userService" class="de.kapsel.um.services.UserService">
		<property name="userDAO" ref="userDAO" />
	</bean>

	<!-- DAO Declaration -->
	<bean id="userDAO" class="de.kapsel.um.dao.UserDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	
	<!-- AUFTRAG DECLARATION -->
	<bean id="auftrag" class="de.kapsel.auftrag.entities.Auftrag" />
	<bean id="auftragService" class="de.kapsel.auftrag.services.AuftragService">
		<property name="auftragDAO" ref="auftragDAO" />
	</bean>
	<bean id="auftragDAO" class="de.kapsel.auftrag.dao.AuftragDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- KUNDE DECLARATION -->
	<bean id="kunde" class="de.kapsel.kunde.entities.Kunde"/>
	<bean id="kundeService" class="de.kapsel.kunde.services.KundeService">
		<property name="kundeDAO" ref="kundeDAO" />
	</bean>
	<bean id="kundeDAO" class="de.kapsel.kunde.dao.KundeDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- KUNDENGRUPPE DECLARATION -->
	<bean id="kgruppe" class="de.kapsel.kunde.entities.KGruppe" />
	<bean id="kgruppeService" class="de.kapsel.kunde.services.KGruppeService">
		<property name="kgruppeDAO" ref="kgruppeDAO" />
	</bean>
	<bean id="kgruppeDAO" class="de.kapsel.kunde.dao.KGruppeDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- PRODUKT DECLARATION -->
	<bean id="produkt" class="de.kapsel.produkt.entities.Produkt" />
	<bean id="produktService" class="de.kapsel.produkt.services.ProduktService">
		<property name="produktDAO" ref="produktDAO" />
	</bean>
	<bean id="produktDAO" class="de.kapsel.produkt.dao.ProduktDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- BAUTEIL DECLARATION -->
	<bean id="bauteil" class="de.kapsel.produkt.entities.Bauteil" />
	<bean id="bauteilService" class="de.kapsel.produkt.services.BauteilService">
		<property name="bauteilDAO" ref="bauteilDAO" />
	</bean>
	<bean id="bauteilDAO" class="de.kapsel.produkt.dao.BauteilDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- MATERIAL DECLARATION -->
	<bean id="material" class="de.kapsel.produkt.entities.Material" />
	<bean id="materialService" class="de.kapsel.produkt.services.MaterialService">
		<property name="materialDAO" ref="materialDAO" />
	</bean>
	<bean id="materialDAO" class="de.kapsel.produkt.dao.MaterialDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- ARBEITSSCHRITT DECLARATION -->
	<bean id="arbeitsschritt" class="de.kapsel.produkt.entities.Arbeitsschritt" />
	<bean id="arbeitsschrittService" class="de.kapsel.produkt.services.ArbeitsschrittService">
		<property name="arbeitsschrittDAO" ref="arbeitsschrittDAO" />
	</bean>
	<bean id="arbeitsschrittDAO" class="de.kapsel.produkt.dao.ArbeitsschrittDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- WERKZEUG DECLARATION -->
	<bean id="werkzeug" class="de.kapsel.produkt.entities.Werkzeug" />
	<bean id="werkzeugService" class="de.kapsel.produkt.services.WerkzeugService">
		<property name="werkzeugDAO" ref="werkzeugDAO" />
	</bean>
	<bean id="werkzeugDAO" class="de.kapsel.produkt.dao.WerkzeugDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	<!-- Adresse DECLARATION -->
	<bean id="adresse" class="de.kapsel.global.Adresse" />
	<bean id="adresseService" class="de.kapsel.global.services.AdresseService">
		<property name="adresseDAO" ref="adresseDAO" />
	</bean>
	<bean id="adresseDAO" class="de.kapsel.global.dao.AdresseDAO">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
    
    <!-- Enable the configuration of transactional behavior based on annotations -->
    <tx:annotation-driven transaction-manager="txManager"/>
 
    <!-- Transaction Manager is defined -->
    <bean id="txManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
       <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

</beans>